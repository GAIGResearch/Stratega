GameConfig:
    Type: TBS
    RoundLimit: 100
    FogOfWar: true

Agents:
    - HumanAgent
    - OSLAAgent

GameRenderer:
    Resolution:
        Width: 800
        Height: 600
    Default Assets:
        FogOfWar: ../../assets/Tiles/notVisible.png
    GridIsIsometric: true
    TileSpriteOrigin:
        Width: 128
        Height: 112
    EntitySpriteOrigin:
        Width: 256
        Height: 360
    TileSpriteSize:
        Width: 256
        Height: 144
    EntitySpriteSize:
        Width: 512
        Height: 512
    #Optional:
    #Font: ../../assets/arial.ttf
    #OutlineShader: ../../assets/OutLine.frag

Tiles:
    Plain:
        Sprite: ../../assets/Tiles/plain.png
        Symbol: .
        IsWalkable: true
        DefaultTile: true
    Water:
        Sprite: ../../assets/Tiles/water.png
        Symbol: W
        IsWalkable: false
    Mountain:
        Sprite: ../../assets/Tiles/rock.png
        Symbol: M
        IsWalkable: false
    Forest:
        Sprite: ../../assets/Tiles/forest.png
        Symbol: F
        IsWalkable: true
        
Board:
    GenerationType: Manual
    Layout: |-
        M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M
        M  .  .  .  .  .  .  .  .  .  .  .  .  .  M  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  M
        M  .  .  .  .  .  .  .  .  W  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  M
        M  .  .  a1 .  .  .  .  .  W  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  M
        M  .  a1 k1 h1 .  .  .  .  W  W  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  M
        M  .  .  w1 w1 .  .  .  .  W  W  .  .  .  .  .  .  .  .  .  .  .  M  M  .  .  .  .  .  M  M  M
        M  .  .  .  .  .  .  .  .  .  W  W  W  W  .  .  .  .  .  .  .  .  W  W  W  W  W  W  W  W  W  W
        M  .  .  .  .  .  .  .  .  .  W  W  W  W  .  .  .  .  .  .  .  .  W  W  W  W  W  W  W  W  W  W
        M  M  M  .  .  .  .  .  .  .  .  .  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W
        M  .  .  .  .  .  .  .  .  .  .  .  .  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W  W
        M  .  .  .  .  .  .  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  .  W  W  W  W  W
        M  M  M  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  W  W  W  W  W
        M  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  a0 .  .  .  .  .  .  M
        M  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  a0 k0 h0 .  p  .  .  .  M
        M  M  M  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  w0 w0 p  p  .  .  .  M
        M  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  p  p  .  .  .  M
        M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M  M
Actions:
    Spawn:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: Position
                SamplingMethod: 
                    Type: Neighbours
                    Options:
                        Shape: Circle
                        Size: 3
                Conditions:
                    - "IsWalkable(Target)"
        Effects:
            - "SpawnEntity(Source, Warrior, Target)"

    Attack:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: Entity
                ValidTargets: [Entities]
                SamplingMethod:
                    Type: Neighbours
                    Options:
                        Shape: AllPositions
                Conditions:
                    #- "DifferentPlayer(Source, Target)"
                    - "InRange(Source, Target, Source.AttackRange)"
        Effects:
            - "Attack(Target.Health, Source.AttackDamage)"

    Move:
        Type: EntityAction
        Preconditions:
            - "ResourceGreaterEqual(Source.MovementPoints, 1)"
        Targets:
            Target:
                Type: Position
                SamplingMethod: 
                    Type: Dijkstra
                    Options:
                        SearchSize: 3
                        AllowDiagonals: false
                #    Type: Neighbours
                #    Options:
                #        Shape: Circle
                #        Size: 1
                Conditions:
                    - "IsWalkable(Target)"
        Effects:
            - "Move(Source, Target)"
            - "ModifyResource(Source.MovementPoints, -1)"

    Heal:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: Entity
                ValidTargets: [Entities]
                SamplingMethod:
                    Type: Neighbours
                    Options:
                        Shape: AllPositions
                Conditions:
                    - "InRange(Source, Target, Source.HealRange)"
        Effects:
            - "ModifyResource(Target.Health, Source.HealAmount)"

    PickUp:
        Type: EntityAction
        Preconditions:
            - "HasNotInventoryFull(Source)"
        Cooldown: 1
        Targets:
            Target:
                Type: Entity
                ValidTargets: Object
                SamplingMethod:
                    Type: Neighbours
                    Options:
                        Shape: AllPositions
                Conditions:
                    - "InRange(Source, Target, Source.AttackRange)"
        Effects:
            - "PickUp(Source, Target)"

    EquipObject:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: Object
                Conditions:
                    - "CanEquipObject(Source, Target)"
        Effects:
            - "EquipObject(Source, Target)"

    UnEquipObject:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: SlotObject
        Effects:
            - "UnEquipObject(Source, Target)"

    UseObject:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: Object
        Effects:
            - "UseObject(Source, Target)"

    UseSlotObject:
        Type: EntityAction
        Cooldown: 1
        Targets:
            Target:
                Type: SlotObject
        Effects:
            - "UseSlotObject(Source, Target)"

    
Entities:
    Warrior:
        Sprite: ../../assets/Entities/unit_2.png
        Symbol: w
        LineOfSightRange: 6
        Actions: [Attack, Move, PickUp, EquipObject, UnEquipObject]
        InventorySize: 4
        Slots: [Left hand, Right hand]
        Parameters:
            Health: 200
            AttackRange: 2
            AttackDamage: 100
            MovementPoints: 2

    Archer:
        Sprite: ../../assets/Entities/unit_3.png
        Symbol: a
        LineOfSightRange: 10
        Parameters:
            Health: 100
            AttackRange: 5
            AttackDamage: 10
            MovementPoints: 2
        Actions: [Attack, Move]

    Healer:
        Sprite: ../../assets/Entities/unit_6.png
        Symbol: h
        LineOfSightRange: 4
        Parameters:
            Health: 40
            HealRange: 2
            HealAmount: 10
            MovementPoints: 5
        Actions: [Heal, Move]

    King:
        Sprite: ../../assets/Entities/unit_1.png
        Symbol: k
        LineOfSightRange: 6
        InventorySize: 4
        Slots: [Left hand, Right hand]
        Parameters:
            Health: 400
            AttackRange: 2
            AttackDamage: 100
            MovementPoints: 1
        Actions: [Attack, Move, Spawn]

Objects:
    HealthPotion:
        Sprite: ../../assets/Entities/arrow.png
        Symbol: p
        CanEquip: [King, Warrior] #Who can equip the object in the slots
        SlotsUse: [Right hand] #empty == cant be equiped in any slot

        #Source object , Target entity
        OnEquip: #effects executed when the object is added to a slot
            - "ModifyResource(Target.Health, Source.HealAmount)"
        OnAddedInventory: #effects executed when the object is added to the inventory
            - "ModifyResource(Target.Health, Source.HealAmount)"
        OnUseSlot: #effects executed when the object is used in the slot
            - "ModifyResource(Target.Health, Source.HealAmount)"
        OnUseInventory: #effects executed when the object is used in the inventory
            - "ModifyResource(Target.Health, Source.HealAmount)"

        OnTickActions: [Heal] #Execute when in on slot or inventory
        Parameters:
            HealAmount: 20
            HealRange: 2

EntityGroups:
    Object: [HealthPotion]
    Entities: [King, Warrior, Archer, Healer]

ForwardModel:
    LoseConditions: #If true: Player -> cant play
        NoHasKing:
        - "HasNoEntity(Source, King)"

    Trigger:
        - OnTick:
            Type: Entity
            ValidTargets: Entities
            Effects:
                - "SetToMaximum(Source.MovementPoints)"

#Action categories
GameDescription:
    Type: CombatGame
    Actions:
        Move: [Move]
        Heal: [Heal]
        Attack: [Attack]
    Entities:
        Unit: [King, Warrior, Archer, Healer]
        Fighter: [Warrior, Archer]
        NoFighter: [Healer]
        Melee: [Warrior]
        Ranged: [Archer]

GameRunner:
    AgentInitializationTime:
        Enabled: false
        BudgetTimeMs: 50
        DisqualificationTimeMs: 70
    AgentComputationTime:
        Enabled: false
        BudgetTimeMs: 1000
        DisqualificationTimeMs: 70
        MaxNumberWarnings: 5